{"ast":null,"code":"var _jsxFileName = \"/Users/vivek/Desktop/multi-cloud-storage/frontend/src/context/CloudContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect, useCallback } from 'react';\nimport cloudService from '../services/cloudService';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CloudContext = /*#__PURE__*/createContext(null);\nexport const CloudProvider = ({\n  children\n}) => {\n  _s();\n  const [cloudAccounts, setCloudAccounts] = useState([]);\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedAccount, setSelectedAccount] = useState(null);\n  const {\n    user\n  } = useAuth();\n\n  // Use useCallback to memoize functions and prevent infinite loops\n  const fetchCloudAccounts = useCallback(async () => {\n    if (!user) return;\n    try {\n      setLoading(true);\n      const accounts = await cloudService.getCloudAccounts();\n      setCloudAccounts(accounts);\n\n      // Auto-select first account if available and none selected\n      if (accounts.length > 0 && !selectedAccount) {\n        setSelectedAccount(accounts[0]);\n      }\n    } catch (error) {\n      console.error('Error fetching cloud accounts:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [user, selectedAccount]);\n  const fetchFiles = useCallback(async accountId => {\n    try {\n      setLoading(true);\n      const fileList = await cloudService.getFiles(accountId);\n      setFiles(fileList);\n    } catch (error) {\n      console.error('Error fetching files:', error);\n      setFiles([]);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Fetch cloud accounts only once when user logs in\n  useEffect(() => {\n    if (user) {\n      fetchCloudAccounts();\n    }\n  }, [user]); // Only depend on user, not fetchCloudAccounts\n\n  // Fetch files when selected account changes\n  useEffect(() => {\n    if (selectedAccount) {\n      fetchFiles(selectedAccount.id);\n    }\n  }, [selectedAccount === null || selectedAccount === void 0 ? void 0 : selectedAccount.id]); // Only depend on selectedAccount id\n\n  const uploadFile = async (accountId, file, onProgress) => {\n    try {\n      setLoading(true);\n      const uploadedFile = await cloudService.uploadFile(accountId, file, onProgress);\n\n      // Refresh files\n      await fetchFiles(accountId);\n      return uploadedFile;\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const downloadFile = async (fileId, fileName) => {\n    try {\n      await cloudService.downloadFile(fileId, fileName);\n    } catch (error) {\n      console.error('Error downloading file:', error);\n      throw error;\n    }\n  };\n  const deleteFile = async fileId => {\n    try {\n      setLoading(true);\n      await cloudService.deleteFile(fileId);\n\n      // Refresh files\n      if (selectedAccount) {\n        await fetchFiles(selectedAccount.id);\n      }\n    } catch (error) {\n      console.error('Error deleting file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const renameFile = async (fileId, newName) => {\n    try {\n      setLoading(true);\n      await cloudService.renameFile(fileId, newName);\n\n      // Refresh files\n      if (selectedAccount) {\n        await fetchFiles(selectedAccount.id);\n      }\n    } catch (error) {\n      console.error('Error renaming file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const connectGoogleDrive = () => {\n    cloudService.connectGoogleDrive(user === null || user === void 0 ? void 0 : user.username);\n  };\n  const connectOneDrive = () => {\n    cloudService.connectOneDrive(user === null || user === void 0 ? void 0 : user.username);\n  };\n  return /*#__PURE__*/_jsxDEV(CloudContext.Provider, {\n    value: {\n      cloudAccounts,\n      files,\n      loading,\n      selectedAccount,\n      setSelectedAccount,\n      fetchCloudAccounts,\n      fetchFiles,\n      uploadFile,\n      downloadFile,\n      deleteFile,\n      renameFile,\n      connectGoogleDrive,\n      connectOneDrive\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n};\n_s(CloudProvider, \"6t6z6AYQasrQQpktWsWfv6gXnK0=\", false, function () {\n  return [useAuth];\n});\n_c = CloudProvider;\nexport const useCloud = () => {\n  _s2();\n  const context = useContext(CloudContext);\n  if (!context) {\n    throw new Error('useCloud must be used within a CloudProvider');\n  }\n  return context;\n};\n_s2(useCloud, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"CloudProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useCallback","cloudService","useAuth","jsxDEV","_jsxDEV","CloudContext","CloudProvider","children","_s","cloudAccounts","setCloudAccounts","files","setFiles","loading","setLoading","selectedAccount","setSelectedAccount","user","fetchCloudAccounts","accounts","getCloudAccounts","length","error","console","fetchFiles","accountId","fileList","getFiles","id","uploadFile","file","onProgress","uploadedFile","downloadFile","fileId","fileName","deleteFile","renameFile","newName","connectGoogleDrive","username","connectOneDrive","Provider","value","_jsxFileName","lineNumber","columnNumber","_c","useCloud","_s2","context","Error","$RefreshReg$"],"sources":["/Users/vivek/Desktop/multi-cloud-storage/frontend/src/context/CloudContext.jsx"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';\nimport cloudService from '../services/cloudService';\nimport { useAuth } from './AuthContext';\n\nconst CloudContext = createContext(null);\n\nexport const CloudProvider = ({ children }) => {\n  const [cloudAccounts, setCloudAccounts] = useState([]);\n  const [files, setFiles] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedAccount, setSelectedAccount] = useState(null);\n  const { user } = useAuth();\n\n  // Use useCallback to memoize functions and prevent infinite loops\n  const fetchCloudAccounts = useCallback(async () => {\n    if (!user) return;\n    \n    try {\n      setLoading(true);\n      const accounts = await cloudService.getCloudAccounts();\n      setCloudAccounts(accounts);\n      \n      // Auto-select first account if available and none selected\n      if (accounts.length > 0 && !selectedAccount) {\n        setSelectedAccount(accounts[0]);\n      }\n    } catch (error) {\n      console.error('Error fetching cloud accounts:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [user, selectedAccount]);\n\n  const fetchFiles = useCallback(async (accountId) => {\n    try {\n      setLoading(true);\n      const fileList = await cloudService.getFiles(accountId);\n      setFiles(fileList);\n    } catch (error) {\n      console.error('Error fetching files:', error);\n      setFiles([]);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Fetch cloud accounts only once when user logs in\n  useEffect(() => {\n    if (user) {\n      fetchCloudAccounts();\n    }\n  }, [user]); // Only depend on user, not fetchCloudAccounts\n\n  // Fetch files when selected account changes\n  useEffect(() => {\n    if (selectedAccount) {\n      fetchFiles(selectedAccount.id);\n    }\n  }, [selectedAccount?.id]); // Only depend on selectedAccount id\n\n  const uploadFile = async (accountId, file, onProgress) => {\n    try {\n      setLoading(true);\n      const uploadedFile = await cloudService.uploadFile(accountId, file, onProgress);\n      \n      // Refresh files\n      await fetchFiles(accountId);\n      \n      return uploadedFile;\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadFile = async (fileId, fileName) => {\n    try {\n      await cloudService.downloadFile(fileId, fileName);\n    } catch (error) {\n      console.error('Error downloading file:', error);\n      throw error;\n    }\n  };\n\n  const deleteFile = async (fileId) => {\n    try {\n      setLoading(true);\n      await cloudService.deleteFile(fileId);\n      \n      // Refresh files\n      if (selectedAccount) {\n        await fetchFiles(selectedAccount.id);\n      }\n    } catch (error) {\n      console.error('Error deleting file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renameFile = async (fileId, newName) => {\n    try {\n      setLoading(true);\n      await cloudService.renameFile(fileId, newName);\n      \n      // Refresh files\n      if (selectedAccount) {\n        await fetchFiles(selectedAccount.id);\n      }\n    } catch (error) {\n      console.error('Error renaming file:', error);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const connectGoogleDrive = () => {\n    cloudService.connectGoogleDrive(user?.username);\n  };\n\n  const connectOneDrive = () => {\n    cloudService.connectOneDrive(user?.username);\n  };\n\n  return (\n    <CloudContext.Provider\n      value={{\n        cloudAccounts,\n        files,\n        loading,\n        selectedAccount,\n        setSelectedAccount,\n        fetchCloudAccounts,\n        fetchFiles,\n        uploadFile,\n        downloadFile,\n        deleteFile,\n        renameFile,\n        connectGoogleDrive,\n        connectOneDrive,\n      }}\n    >\n      {children}\n    </CloudContext.Provider>\n  );\n};\n\nexport const useCloud = () => {\n  const context = useContext(CloudContext);\n  if (!context) {\n    throw new Error('useCloud must be used within a CloudProvider');\n  }\n  return context;\n};"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC1F,OAAOC,YAAY,MAAM,0BAA0B;AACnD,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,YAAY,gBAAGT,aAAa,CAAC,IAAI,CAAC;AAExC,OAAO,MAAMU,aAAa,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC7C,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACc,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACgB,OAAO,EAAEC,UAAU,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACkB,eAAe,EAAEC,kBAAkB,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM;IAAEoB;EAAK,CAAC,GAAGf,OAAO,CAAC,CAAC;;EAE1B;EACA,MAAMgB,kBAAkB,GAAGlB,WAAW,CAAC,YAAY;IACjD,IAAI,CAACiB,IAAI,EAAE;IAEX,IAAI;MACFH,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMK,QAAQ,GAAG,MAAMlB,YAAY,CAACmB,gBAAgB,CAAC,CAAC;MACtDV,gBAAgB,CAACS,QAAQ,CAAC;;MAE1B;MACA,IAAIA,QAAQ,CAACE,MAAM,GAAG,CAAC,IAAI,CAACN,eAAe,EAAE;QAC3CC,kBAAkB,CAACG,QAAQ,CAAC,CAAC,CAAC,CAAC;MACjC;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACxD,CAAC,SAAS;MACRR,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC,EAAE,CAACG,IAAI,EAAEF,eAAe,CAAC,CAAC;EAE3B,MAAMS,UAAU,GAAGxB,WAAW,CAAC,MAAOyB,SAAS,IAAK;IAClD,IAAI;MACFX,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMY,QAAQ,GAAG,MAAMzB,YAAY,CAAC0B,QAAQ,CAACF,SAAS,CAAC;MACvDb,QAAQ,CAACc,QAAQ,CAAC;IACpB,CAAC,CAAC,OAAOJ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7CV,QAAQ,CAAC,EAAE,CAAC;IACd,CAAC,SAAS;MACRE,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAf,SAAS,CAAC,MAAM;IACd,IAAIkB,IAAI,EAAE;MACRC,kBAAkB,CAAC,CAAC;IACtB;EACF,CAAC,EAAE,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC;;EAEZ;EACAlB,SAAS,CAAC,MAAM;IACd,IAAIgB,eAAe,EAAE;MACnBS,UAAU,CAACT,eAAe,CAACa,EAAE,CAAC;IAChC;EACF,CAAC,EAAE,CAACb,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEa,EAAE,CAAC,CAAC,CAAC,CAAC;;EAE3B,MAAMC,UAAU,GAAG,MAAAA,CAAOJ,SAAS,EAAEK,IAAI,EAAEC,UAAU,KAAK;IACxD,IAAI;MACFjB,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMkB,YAAY,GAAG,MAAM/B,YAAY,CAAC4B,UAAU,CAACJ,SAAS,EAAEK,IAAI,EAAEC,UAAU,CAAC;;MAE/E;MACA,MAAMP,UAAU,CAACC,SAAS,CAAC;MAE3B,OAAOO,YAAY;IACrB,CAAC,CAAC,OAAOV,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7C,MAAMA,KAAK;IACb,CAAC,SAAS;MACRR,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMmB,YAAY,GAAG,MAAAA,CAAOC,MAAM,EAAEC,QAAQ,KAAK;IAC/C,IAAI;MACF,MAAMlC,YAAY,CAACgC,YAAY,CAACC,MAAM,EAAEC,QAAQ,CAAC;IACnD,CAAC,CAAC,OAAOb,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF,CAAC;EAED,MAAMc,UAAU,GAAG,MAAOF,MAAM,IAAK;IACnC,IAAI;MACFpB,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMb,YAAY,CAACmC,UAAU,CAACF,MAAM,CAAC;;MAErC;MACA,IAAInB,eAAe,EAAE;QACnB,MAAMS,UAAU,CAACT,eAAe,CAACa,EAAE,CAAC;MACtC;IACF,CAAC,CAAC,OAAON,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,MAAMA,KAAK;IACb,CAAC,SAAS;MACRR,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMuB,UAAU,GAAG,MAAAA,CAAOH,MAAM,EAAEI,OAAO,KAAK;IAC5C,IAAI;MACFxB,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMb,YAAY,CAACoC,UAAU,CAACH,MAAM,EAAEI,OAAO,CAAC;;MAE9C;MACA,IAAIvB,eAAe,EAAE;QACnB,MAAMS,UAAU,CAACT,eAAe,CAACa,EAAE,CAAC;MACtC;IACF,CAAC,CAAC,OAAON,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,MAAMA,KAAK;IACb,CAAC,SAAS;MACRR,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMyB,kBAAkB,GAAGA,CAAA,KAAM;IAC/BtC,YAAY,CAACsC,kBAAkB,CAACtB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEuB,QAAQ,CAAC;EACjD,CAAC;EAED,MAAMC,eAAe,GAAGA,CAAA,KAAM;IAC5BxC,YAAY,CAACwC,eAAe,CAACxB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEuB,QAAQ,CAAC;EAC9C,CAAC;EAED,oBACEpC,OAAA,CAACC,YAAY,CAACqC,QAAQ;IACpBC,KAAK,EAAE;MACLlC,aAAa;MACbE,KAAK;MACLE,OAAO;MACPE,eAAe;MACfC,kBAAkB;MAClBE,kBAAkB;MAClBM,UAAU;MACVK,UAAU;MACVI,YAAY;MACZG,UAAU;MACVC,UAAU;MACVE,kBAAkB;MAClBE;IACF,CAAE;IAAAlC,QAAA,EAEDA;EAAQ;IAAA4B,QAAA,EAAAS,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACY,CAAC;AAE5B,CAAC;AAACtC,EAAA,CA/IWF,aAAa;EAAA,QAKPJ,OAAO;AAAA;AAAA6C,EAAA,GALbzC,aAAa;AAiJ1B,OAAO,MAAM0C,QAAQ,GAAGA,CAAA,KAAM;EAAAC,GAAA;EAC5B,MAAMC,OAAO,GAAGpD,UAAU,CAACO,YAAY,CAAC;EACxC,IAAI,CAAC6C,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,8CAA8C,CAAC;EACjE;EACA,OAAOD,OAAO;AAChB,CAAC;AAACD,GAAA,CANWD,QAAQ;AAAA,IAAAD,EAAA;AAAAK,YAAA,CAAAL,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}